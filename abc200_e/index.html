
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://nat-chan.github.io/abc200_e/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.4">
    
    
      
        <title>ABC200-E Patisserie ABC 2 - â„•</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#abc200-e-patisserie-abc-2" class="md-skip">
          ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã‚¹ã‚­ãƒƒãƒ—
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ãƒ˜ãƒƒãƒ€ãƒ¼">
    <a href=".." title="â„•" class="md-header__button md-logo" aria-label="â„•" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            â„•
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ABC200-E Patisserie ABC 2
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black" type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo" type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æ¤œç´¢" placeholder="æ¤œç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="ã‚¯ãƒªã‚¢" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ¤œç´¢ã‚’åˆæœŸåŒ–
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="â„•" class="md-nav__button md-logo" aria-label="â„•" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    â„•
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../abc186_d/" class="md-nav__link">
        ABC186-D Sum of difference
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ABC200-E Patisserie ABC 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ABC200-E Patisserie ABC 2
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="ç›®æ¬¡">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®æ¬¡
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tags-atcoder" class="md-nav__link">
    tags: atcoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    å•é¡Œæ–‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    åˆ¶ç´„
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    æ–¹é‡ã€Œéšå±¤ã”ã¨ã«è§£å€™è£œã®å€‹æ•°ã‚’æ±‚ã‚ã€å–ã‚Šã¤ãã™ã€
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ
  </a>
  
    <nav class="md-nav" aria-label="ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rm-oracle_1l" class="md-nav__link">
    ${\rm oracle_1}(l)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_2l-i" class="md-nav__link">
    ${\rm oracle_2}(l, i)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_3l-i-j" class="md-nav__link">
    ${\rm oracle_3}(l, i, j)$
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    é–¢é€£ã™ã‚‹è©±é¡Œ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    å®Ÿè£…
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="ç›®æ¬¡">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®æ¬¡
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tags-atcoder" class="md-nav__link">
    tags: atcoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    å•é¡Œæ–‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    åˆ¶ç´„
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    æ–¹é‡ã€Œéšå±¤ã”ã¨ã«è§£å€™è£œã®å€‹æ•°ã‚’æ±‚ã‚ã€å–ã‚Šã¤ãã™ã€
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ
  </a>
  
    <nav class="md-nav" aria-label="ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rm-oracle_1l" class="md-nav__link">
    ${\rm oracle_1}(l)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_2l-i" class="md-nav__link">
    ${\rm oracle_2}(l, i)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_3l-i-j" class="md-nav__link">
    ${\rm oracle_3}(l, i, j)$
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    é–¢é€£ã™ã‚‹è©±é¡Œ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    å®Ÿè£…
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="abc200-e-patisserie-abc-2">ABC200-E Patisserie ABC 2</h1>
<h6 id="tags-atcoder">tags: <code>atcoder</code></h6>
<h2 id="_1">å•é¡Œæ–‡</h2>
<p>URL: <a href="https://atcoder.jp/contests/abc200/tasks/abc200_e">https://atcoder.jp/contests/abc200/tasks/abc200_e</a></p>
<p>
<script type="math/tex; mode=display">
0 \le i,j,k < N \tag{1}
</script>
ã“ã®ä¸ç­‰å¼ã‚’æº€ãŸã™$N^3$å€‹ã®æ•´æ•°ã®3ã¤çµ„$(i,j,k)$ã‚’ä»¥ä¸‹ã®é †åºã§ä¸¦ã¹ã‚‹ã€‚</p>
<ul>
<li>$i+j+k$ ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚</li>
<li>ã“ã“ã¾ã§ã§é †åºãŒã¤ã‹ãªã‘ã‚Œã°ã€$i$ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚</li>
<li>ã“ã“ã¾ã§ã§é †åºãŒã¤ã‹ãªã‘ã‚Œã°ã€$j$ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚</li>
</ul>
<p>ã“ã®ã¨ãã€å·¦ã‹ã‚‰$K$ç•ªç›®ã«ã‚ã‚‹æ•´æ•°ã®3ã¤çµ„$(i,j,k)$ã‚’ç­”ãˆãªã•ã„ã€‚</p>
<p>â€»æœ¬æ¥ã®å•é¡Œæ–‡ã§ã¯å¤‰æ•°ã®å‹•ãç¯„å›²ãŒ$1\le i,j,k \le N$ã§ã‚ã‚‹ã€‚
ã—ã‹ã—ãªãŒã‚‰<code>0-indexed</code>ã«ã™ã‚‹ã¨å®Ÿè£…ä¸Šéƒ½åˆãŒè‰¯ã„ã®ã§ã“ã®ã‚ˆã†ã«è¨€ã„æ›ãˆãŸã€‚
å…ƒã®å•é¡Œã«å¯¾ã—ã¦ã¯ä»Šå›å¾—ã‚‰ã‚ŒãŸè§£$(i^\ast, j^\ast, k^\ast)$ã‚’ç”¨ã„ã¦
$(i^\ast+1,j^\ast+1,k^\ast+1)$ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚
ä»¥é™ã“ã®ã‚ˆã†ã«å‹•ãå¤‰æ•°ã«å¯¾ã—ã¦å¾—ã‚‰ã‚ŒãŸ(å›ºå®šã•ã‚ŒãŸ)å¤‰æ•°ã‚’$\ast$ã‚’ã¤ã‘ã¦åŒºåˆ¥ã™ã‚‹ã€‚</p>
<h2 id="_2">åˆ¶ç´„</h2>
<ul>
<li>å…¥åŠ›ã¯å…¨ã¦æ•´æ•°</li>
<li>$1\le N \le 10^6$</li>
<li>$1\le K \le N^3$</li>
</ul>
<p>3ã¤çµ„$(i,j,k)$ã‚’$K$ç•ªç›®ã«åˆ°é”ã™ã‚‹ã¾ã§å°ã•ã„é †ã«åˆ—æŒ™ã™ã‚‹$O(N^3)ã®$æ„šç›´è§£ãŒã¾ãšæ€ã„ã¤ãã€‚
ã—ã‹ã—ã€ä»Šå›ã®åˆ¶ç´„ã§ã¯$O(N^3)$ã¯ãŠã‚ã‹$O(N^2)$ã™ã‚‰é€šã‚‰ãªã„ã€‚$O(N)$ã¾ã§è½ã¨ã™æ–¹æ³•ã‚’è€ƒãˆã‚‹ã€‚</p>
<h2 id="_3">æ–¹é‡ã€Œéšå±¤ã”ã¨ã«è§£å€™è£œã®å€‹æ•°ã‚’æ±‚ã‚ã€å–ã‚Šã¤ãã™ã€</h2>
<p>3ã¤çµ„$(i,j,k)$ã¯$i+j+k=l$ã®å€¤ã«ã‚ˆã£ã¦ã„ãã¤ã‹ã®éšå±¤ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚
ã“ã®éšå±¤ã¯ã„ãã¤ã‚ã‚‹ã ã‚ã†ã‹ã€ã¾ãš$l$ã®å–ã‚Šã†ã‚‹å€¤ã®ç¯„å›²ã‚’è€ƒãˆã‚‹ã€‚
$i=j=k=0$ã®ã¨ãã€æœ€å°å€¤$l=0$ã‚’å–ã‚Šã€
$i=j=k=N-1$ã®ã¨ãã€æœ€å¤§å€¤$l=3N-3$ã‚’å–ã‚‹ã€‚
ã¤ã¾ã‚Š$0\le l&lt;3N-2$ã®é–“ã®$3N-2$å€‹ã®å€¤ã‚’$l$ã¯æ¼ã‚Œãªãå–ã‚Šã†ã‚‹ã€‚</p>
<p>æ±‚ã‚ãŸã„$K$ç•ªç›®ã®3ã¤çµ„$(i,j,k)$ãŒã©ã®éšå±¤ã«å±ã—ã¦ã„ã‚‹ã‹ã‚’çŸ¥ã‚ŠãŸã„ã€‚
ãã®ãŸã‚ã«ã€æ™‚é–“è¨ˆç®—é‡$O(1)$ã§æ¬¡ã®å•ã„ã«ç­”ãˆã‚‹ã“ã¨ã®ã§ãã‚‹3ã¤ã®ã‚ªãƒ©ã‚¯ãƒ«ã®å­˜åœ¨ã‚’ä»®å®šã™ã‚‹ã€‚</p>
<ul>
<li>${\rm oracle_1}(l) :=$ã€Œ$l$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€</li>
<li>${\rm oracle_2}(l,i) :=$ã€Œ$l,i$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€</li>
<li>${\rm oracle_3}(l,i,j) :=$ã€Œ$l,i,j$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€</li>
</ul>
<p>${\rm oracle_1}(l)$ã‚’ç”¨ã„ã¦ç´¯ç©å’Œã®è€ƒãˆæ–¹ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€
<script type="math/tex; mode=display">
\sum_{l=1}^{l^{\ast}-1}{\rm oracle_1}(l) < K \le \sum_{l=1}^{l^{\ast}}{\rm oracle_1}(l)
</script>
ã‚’æº€ãŸã™$l^{\ast}$ã‚’æ™‚é–“è¨ˆç®—é‡$O(3N-2)=O(N)$ã§æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
ã“ã®çµæœã‹ã‚‰ã€$K$ç•ªç›®ã®3ã¤çµ„$(i,j,k)$ãŒéšå±¤$l^\ast$ã«å±ã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚</p>
<p>ã•ã¦ã€$l^\ast=i+j+k$ã‚’æº€ãŸã™è§£å€™è£œã¯æ„šç›´è§£ã‚ˆã‚Šã‚‚ã•ã‚‰ã«çµã‚Šè¾¼ã‚ãŸã€‚ã—ã‹ã—ãªãŒã‚‰ã€
ç¾æ™‚ç‚¹ã§å€™è£œã‚’åˆ—æŒ™ã™ã‚‹ã«ã¯$i$ã¨$j$ã®2ã¤ã®å¤‰æ•°ã‚’å‹•ã‹ã™å¿…è¦ãŒã‚ã‚Šã€$O(N^2)$ã®æ™‚é–“è¨ˆç®—é‡ãŒã‹ã‹ã£ã¦ã—ã¾ã†ã€‚
ãã“ã§ã•ã‚‰ã«${\rm oracle_2}(l, i)$ã‚’ç”¨ã„ã¦$O(N)$ã®æ™‚é–“ã‚’ã‹ã‘ã¦
ã‚ˆã‚Šç´°ã‹ã„ãµã‚‹ã„ã«ã‹ã‘ã‚‹ã‚ˆã†ã«è§£ã®å€™è£œã‚’çµã‚Šã“ã‚€æ–¹é‡ã‚’å–ã‚‹ã€‚</p>
<p>ä»¥é™ã®è­°è«–ã§ã¯$l^\ast$ã®éšå±¤ã®ä¸­ã§æ±‚ã‚ã‚‹è§£ãŒä½•ç•ªç›®ã§ã‚ã‚‹ã‹ã‚’çŸ¥ã‚Œã°ã‚ˆã„ã€‚
å¾“ã£ã¦ã€$l=1,2\cdots l^\ast-1$ã®è§£å€™è£œã¯ã‚‚ã†æ•°ãˆã‚ã’ã‚‹å¿…è¦ãŒç„¡ã„ãŸã‚æ¬¡ã®æ“ä½œã‚’è¡Œã£ã¦ã‚‚å•é¡Œãªã„ã€‚
<script type="math/tex; mode=display">
K' = K-\sum_{l=1}^{l^{\ast}-1}{\rm oracle_1}(l)
</script>
ä»¥ä¸Šã®æ“ä½œã‚’è¡Œã†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’Pythonã§æ›¸ãã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">oracle1</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">-</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">K</span> <span class="o">-=</span> <span class="n">d</span>
</code></pre></div>
</td></tr></table>
<p>å®Ÿéš›ã«${\rm oracle_2}(l, i)$ã‚’ç”¨ã„ã¦éšå±¤$l^\ast$ã®ä¸­ã§$K'$ç•ªç›®ã®3ã¤çµ„ã®$i$ã®å€¤$i^\ast$ã‚’è¨ˆç®—ã™ã‚‹ã®ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚</p>
<p>
<script type="math/tex; mode=display">
\sum_{i=1}^{i^{\ast}-1}{\rm oracle_2}(l, i) < K' \le \sum_{i=1}^{i^{\ast}}{\rm oracle_2}(l, i) \\
K'' = K'-\sum_{i=1}^{i^{\ast}-1}{\rm oracle_2}(l, i)
</script>
</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">oracle2</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">-</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">K</span> <span class="o">-=</span> <span class="n">d</span>
</code></pre></div>
</td></tr></table>
<p>æœ€å¾Œã«${\rm oracle_3}(l, i, j)$ã‚’ç”¨ã„ã¦éšå±¤$l^\ast, i^\ast$ã®ä¸­ã§$K''$ç•ªç›®ã¾ã§ã®è§£å€™è£œã‚’ã™ã¹ã¦å–ã‚Šã¤ãã™ã€‚
<script type="math/tex; mode=display">
\sum_{j=1}^{j^{\ast}-1}{\rm oracle_3}(l, i, j) < K'' \le \sum_{j=1}^{j^{\ast}}{\rm oracle_3}(l, i, j) \\
K''' = K''-\sum_{j=1}^{j^{\ast}-1}{\rm oracle_3}(l, i, j)
</script>
</p>
<p>ã“ã®ã‚ˆã†ã«ã—ã¦å¾—ã‚‰ã‚ŒãŸ$l^\ast, i^\ast, j^\ast$ã‚’ç”¨ã„ã¦
<script type="math/tex; mode=display">
k^\ast = l^\ast - i^\ast - j^\ast
</script>
ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã§æ±‚ã‚ãŸã‹ã£ãŸ$K$ç•ªç›®ã®è§£$(i^\ast,j^\ast,k^\ast)$ã‚’ç­”ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">oracle3</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">-</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">K</span> <span class="o">-=</span> <span class="n">d</span>
</code></pre></div>
</td></tr></table>
<h2 id="_4">ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ</h2>
<iframe src="../abc200_e_level.html" width=800 height=500></iframe>

<h3 id="rm-oracle_1l">${\rm oracle_1}(l)$</h3>
<p>ä¸Šè¨˜ã®ã‚°ãƒ©ãƒ•ã‚’å‹•ã‹ã—ã¦ã»ã—ã„ã€‚ğŸ”µã§ç¤ºã—ãŸåŒºé–“ã§ã¯ãƒ”ãƒ©ãƒŸãƒƒãƒ‰å½¢ã«ãªã£ã¦ãŠã‚Šã€
å„éšå±¤$l=0,1,2\cdots$ã®å€¤ã¯$1,3,6\cdots$ã¨ä¸€èˆ¬é …ã®ç°¡å˜ãªä¸‰è§’æ•°$\Sigma(l+1)$ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
â€»\Sigma(n) = \sum_{i=1}^{n} i = \frac{n(n+1)}{2}
\end{align}
</script>
</p>
<p>ğŸŸ¢ã§ç¤ºã—ãŸåŒºé–“ã§ã¯é€†ãƒ”ãƒ©ãƒŸãƒƒãƒ‰å½¢ã«ãªã£ã¦ãŠã‚Šã€é€†é †ã«æ¸›ã£ã¦ã„ããŸã‚
ä¸‰è§’æ•°ã®ä¸€èˆ¬é …ã«å¯¾ã—ã¦ $l \to 3N-3-l$
ã®å¤‰æ•°å¤‰æ›ã‚’ã™ã‚‹ã“ã¨ã§$\Sigma(3N-2-l)$ã¨å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚</p>
<p>é›£ã—ã„ã®ã¯ğŸ”´ã§ç¤ºã—ãŸåŒºé–“ã§ã‚ã‚‹ã€‚
$(N,0,0)$ã®ã‚ˆã†ã«åŒºé–“$[0,N)$ã«åã¾ã‚‰ãªã„æ•°ãŒå‡ºã¦ãã¦ã—ã¾ã†ã®ã ã€‚
ãã®ã‚ˆã†ãªå ´åˆã®æ•°ã‚’è€ƒãˆã€ä¸‰è§’æ•°ã‹ã‚‰æ¸›ãšã‚‹æ–¹é‡ã‚’å–ã‚‹ã€‚
ã¾ãšè£œé¡Œã¨ã—ã¦$i,j,k$ã®ä¸­ã§$N$ä»¥ä¸Šã®æ•°ã¯1ç¨®é¡ã®ã¿ã§ã‚ã‚‹ã€‚
ã“ã‚Œã¯ğŸ”´ã§ç¤ºã—ãŸåŒºé–“ã§æœ€å¤§ã®$l=2N-1$ã®æ™‚ã§ã‚‚ã€$(N,N-1,0)$ã®ã‚ˆã†ãª
ä¾‹ã—ã‹ä½œã‚Œãªã„ã“ã¨ã‹ã‚‰åˆ†ã‹ã‚‹ã€‚
ã™ãªã‚ã¡$N$ä»¥ä¸Šã®æ•°ã¨ã—ã¦$i,j,k$ã®ã©ã‚Œã‚’é¸ã¶ã‹ã§3é€šã‚Šã®è‡ªç”±åº¦ãŒã‚ã‚‹ã€‚
ä»¥é™ã¯$i$ã¨å›ºå®šã—ã¦å ´åˆã®æ•°ã‚’æ•°ãˆã‚‹ã€‚
$i$ãŒå–ã‚Šã†ã‚‹å€¤ã¯Nã‹ã‚‰lã¾ã§ã§ã‚ã‚Šã€$j$ãŒå–ã‚Šã†ã‚‹å€¤ã¯$0$ã‹ã‚‰$l-i$ã¾ã§ã®$l-i+1$é€šã‚Šã§ã‚ã‚‹ã€‚
$i,j$ãŒå®šã¾ã‚Œã°ã“ã®ç¯„å›²ã§$k$ãŒãŸã ä¸€ã¤ã«å®šã¾ã‚‹ã®ã§ã€æ±‚ã‚ã‚‹å ´åˆã®æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
\sum_{i=N}^{l} l-i+1
&= \sum_{i=l}^{N} i-(l+1) \\
&= \sum_{i=1}^{N-l+1} i \\
&= \Sigma(l+1-N)
\end{align}
</script>
</p>
<p>ä»¥ä¸Šã®ğŸ”µğŸ”´ğŸŸ¢ã®3ã¤ã®åŒºé–“ã®çµæœã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ã§
${\rm oracle_1}(l)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã¾ã£ãŸã€‚</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
{\rm oracle_1}(l) &= \begin{cases}
\Sigma(l+1)                & 0 \le l < N \\
\Sigma(l+1)-3\Sigma(l+1-N) & N \le l < 2N-2 \\
\Sigma(3N-2-l)             & 2N-2 \le l < 3N-2 \\
0                          & (otherwise)
\end{cases}
\end{align}
</script>
</p>
<h3 id="rm-oracle_2l-i">${\rm oracle_2}(l, i)$</h3>
<p>$l,i$ã®å€¤ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹ã¨ãã€$j$ã‚’å®šã‚ã‚Œã°å¯¾å¿œã™ã‚‹$k$ã¯ãŸã $1$ã¤ã«å®šã¾ã‚‹ã€‚
å¾“ã£ã¦$j \in [L, U]$ã¨ä¸Šé™ã¨ä¸‹é™ãŒæ±‚ã¾ã‚Œã°ã€ãã®åŒºé–“ã®å¹…$\max(0, U-L+1)$å€‹ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚
ãªãœã€$\max(0,\cdot)$ã§åŒ…ã‚“ã§ã„ã‚‹ã®ã‹ã€ãã‚Œã¯
$[L, U]=\varnothing$ã¨ãªã‚‹å ´åˆã€
$L$ã¨$U$ã®æ±‚ã‚æ–¹ã«ã‚ˆã£ã¦ã¯$U-L&lt;0$ã¨ãªã‚Šã†ã‚‹ç‚ºã§ã‚ã‚‹ã€‚
å®Ÿéš›ã«ä¸Šé™$U$ã‚’æ±‚ã‚ã‚‹ã€‚$k=0$ã®æ™‚ã€æœ€å¤§å€¤$j=l-i$ã‚’å–ã‚‹ã€‚ãŸã ã—ã€$N-1$ã‚’ä¸Šå›ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã€</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
U = \min(N-1, l-i)
\end{align}
</script>
</p>
<p>ã¨ãªã‚‹ã€‚
ã¾ãŸã€ä¸‹é™$L$ã‚’æ±‚ã‚ã‚‹ã€‚$k=N-1$ã®æ™‚ã€æœ€å°å€¤$j=l-i-(N-1)$ã‚’å–ã‚‹ã€‚ãŸã ã—ã€$0$ã‚’ä¸‹å›ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã€
<script type="math/tex; mode=display">
\begin{align}
L = \max(0, l-i-(N-1))
\end{align}
</script>
</p>
<p>ä»¥ä¸Šã®çµæœã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ã§
${\rm oracle_2}(l, i)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã¾ã£ãŸã€‚</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
{\rm oracle_2}(l, i) = \max(0, \min(N-1, l-i)-\max(0, l-i-(N-1))+1))
\end{align}
</script>
</p>
<h3 id="rm-oracle_3l-i-j">${\rm oracle_3}(l, i, j)$</h3>
<p>å¾Œã¯ç°¡å˜ã§ã‚ã‚‹ã€ä¸ãˆã‚‰ã‚ŒãŸ$l,i,j$ã‹ã‚‰$k=l-i-j$ãŒãŸã $1$ã¤å®šã¾ã‚‹ãŸã‚ã€
$k$ãŒåŒºé–“$[0,N)$ã«åã¾ã£ã¦ã„ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€åã¾ã£ã¦ã„ã‚‹ãªã‚‰$1$å€‹ã€
åã¾ã£ã¦ã„ãªã‘ã‚Œã°$0$å€‹ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
{\rm oracle_3}(l, i, j) = \begin{cases}
1 & 0 \le l-i-j < N \\
0 & (otherwise) \\
\end{cases}
\end{align}
</script>
</p>
<h2 id="_5">é–¢é€£ã™ã‚‹è©±é¡Œ</h2>
<p>ä»Šå›ã®å•é¡Œã¯<strong>Kç•ªç›®ã«å°ã•ã„æ•°ã‚’æ±‚ã‚ã‚‹</strong>ã¨ã„ã†å…¸å‹å•é¡Œã®ä¸€ã¤ã§ã€é’diffç¨‹åº¦ã®é›£æ˜“åº¦ã§ã‚ã£ãŸãŒã€</p>
<p><a href="https://atcoder.jp/contests/abc200/tasks/abc200_e"><span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #0000FF; background: linear-gradient(to top, #0000FF 0%, #0000FF 88.75%, rgba(0, 0, 0, 0) 88.75%, rgba(0, 0, 0, 0) 100%); "></span> ABC200-E Patisserie ABC 2</a></p>
<p>åŒæ§˜ã®è€ƒãˆæ–¹ã§è§£ã‘ã‚‹ã€‚ç·‘diffã®ç·´ç¿’å•é¡Œã¨ã—ã¦æ¬¡ã®å•é¡ŒãŒã‚ã‚‹ã€‚</p>
<p><a href="https://atcoder.jp/contests/abc061/tasks/abc061_c"><span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #008000; background: linear-gradient(to top, #008000 0%, #008000 2%, rgba(0, 0, 0, 0) 2%, rgba(0, 0, 0, 0) 100%); "></span> ABC061-C Big Array</a></p>
<p>ABC200ã®ç¯€ç›®ã‚’è¨˜å¿µã—ã¦ABC100ã®ã‚ªãƒãƒ¼ã‚¸ãƒ¥å•é¡Œã¨ã—ã¦å‡ºé¡Œã•ã‚ŒãŸã‚ˆã†ã ã€‚</p>
<p><a href="https://atcoder.jp/contests/abc100/tasks/abc100_d"><span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #00C0C0; background: linear-gradient(to top, #00C0C0 0%, #00C0C0 32.75%, rgba(0, 0, 0, 0) 32.75%, rgba(0, 0, 0, 0) 100%); "></span> ABC100-D Patisserie ABC</a></p>
<p>ã¾ãŸã€<a href="https://atcoder.jp/contests/abc200/editorial/1247">physics0523ã«ã‚ˆã‚‹è§£èª¬</a>
ã«ã‚ˆã‚‹ã¨ãƒœãƒ¼ãƒŠã‚¹å•é¡Œã¨ã—ã¦ã‚ˆã‚Šå¤§ãã„åˆ¶ç´„ã§è§£ãã“ã¨ãŒå•ã‚ã‚Œã‚‹ã€‚ä»Šå›ã®æ–¹é‡ã‚’æ‹¡å¼µã—ã€ã‚ªãƒ©ã‚¯ãƒ«ã®ç´¯ç©å’Œã‚’ä»£æ•°çš„ã«æ±‚ã‚ãŸã®ã¡ã«2åˆ†æ¢ç´¢ã‚’ç”¨ã„ã‚‹ã“ã¨ã§$O(\log N)$ã§è§£ã‘ã‚‹ã€‚</p>
<h2 id="_6">å®Ÿè£…</h2>
<p>ä»¥ä¸Šã®è€ƒå¯Ÿã‚’è¸ã¾ãˆPythonã§å®Ÿè£…ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚</p>
<p>æå‡ºï¼š<a href="https://atcoder.jp/contests/abc200/submissions/22557207">https://atcoder.jp/contests/abc200/submissions/22557207</a></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sigma</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">oracle1</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sigma</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sigma</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sigma</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">oracle2</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">R</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="o">-</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">oracle3</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="n">N</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">oracle1</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">-</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">K</span> <span class="o">-=</span> <span class="n">d</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">oracle2</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">-</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">K</span> <span class="o">-=</span> <span class="n">d</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">oracle3</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">-</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">K</span> <span class="o">-=</span> <span class="n">d</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>ã¾ãŸã€ã‚°ãƒ©ãƒ•ã®ä½œæˆã«ç”¨ã„ãŸã‚³ãƒ¼ãƒ‰ã‚‚å«ã‚ã¦ãŠãã€‚</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">def</span> <span class="nf">level</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;0â‰¤l&lt;N&quot;</span>
    <span class="k">if</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Nâ‰¤l&lt;2N-2&quot;</span>
    <span class="k">if</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;2N-2â‰¤l&lt;3N-2&quot;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">level</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;j&#39;</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;i+j+k=l&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">,</span>
    <span class="n">z</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;i+j+k=l&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickmode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dtick</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickmode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dtick</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">zaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickmode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dtick</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
                
              
              
                


  <h2 id="__comments">ã‚³ãƒ¡ãƒ³ãƒˆ</h2>
  <div id="disqus_thread"></div>
  <script>var disqus_config=function(){this.page.url="https://nat-chan.github.io/abc200_e/",this.page.identifier="/abc200_e/"};window.addEventListener("load",function(){var e=document,i=e.createElement("script");i.src="//ogino-natsuki-tm.disqus.com/embed.js",i.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(i)})</script>

              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="ãƒ•ãƒƒã‚¿ãƒ¼">
      
        <a href="../abc186_d/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                å‰
              </span>
              ABC186-D Sum of difference
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/mathbbN" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/nat-chan" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+", "search.placeholder": "\u691c\u7d22", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044"}, "search": "../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.1d3bfcf1.min.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../javascripts/extra.js"></script>
      
    
  </body>
</html>