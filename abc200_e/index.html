
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.4">
    
    
      
        <title>ABC200-E Patisserie ABC 2 - â„•</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#abc200-e-patisserie-abc-2" class="md-skip">
          ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã‚¹ã‚­ãƒƒãƒ—
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ãƒ˜ãƒƒãƒ€ãƒ¼">
    <a href=".." title="â„•" class="md-header__button md-logo" aria-label="â„•" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            â„•
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ABC200-E Patisserie ABC 2
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æ¤œç´¢" placeholder="æ¤œç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="ã‚¯ãƒªã‚¢" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ¤œç´¢ã‚’åˆæœŸåŒ–
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="â„•" class="md-nav__button md-logo" aria-label="â„•" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    â„•
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../abc186_d/" class="md-nav__link">
        ABC186-D Sum of difference
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ABC200-E Patisserie ABC 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ABC200-E Patisserie ABC 2
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="ç›®æ¬¡">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®æ¬¡
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tags-atcoder" class="md-nav__link">
    tags: atcoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    å•é¡Œæ–‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    åˆ¶ç´„
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    æ–¹é‡ã€Œéšå±¤ã”ã¨ã«è§£å€™è£œã®å€‹æ•°ã‚’æ±‚ã‚ã€å–ã‚Šã¤ãã™ã€
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ
  </a>
  
    <nav class="md-nav" aria-label="ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rm-oracle_1l" class="md-nav__link">
    ${\rm oracle_1}(l)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_2l-i" class="md-nav__link">
    ${\rm oracle_2}(l, i)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_3l-i-j" class="md-nav__link">
    ${\rm oracle_3}(l, i, j)$
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    å®Ÿè£…
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="ç›®æ¬¡">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®æ¬¡
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tags-atcoder" class="md-nav__link">
    tags: atcoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    å•é¡Œæ–‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    åˆ¶ç´„
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    æ–¹é‡ã€Œéšå±¤ã”ã¨ã«è§£å€™è£œã®å€‹æ•°ã‚’æ±‚ã‚ã€å–ã‚Šã¤ãã™ã€
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ
  </a>
  
    <nav class="md-nav" aria-label="ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rm-oracle_1l" class="md-nav__link">
    ${\rm oracle_1}(l)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_2l-i" class="md-nav__link">
    ${\rm oracle_2}(l, i)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_3l-i-j" class="md-nav__link">
    ${\rm oracle_3}(l, i, j)$
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    å®Ÿè£…
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="abc200-e-patisserie-abc-2">ABC200-E Patisserie ABC 2</h1>
<h6 id="tags-atcoder">tags: <code>atcoder</code></h6>
<h2 id="_1">å•é¡Œæ–‡</h2>
<p>URL: <a href="https://atcoder.jp/contests/abc200/tasks/abc200_e">https://atcoder.jp/contests/abc200/tasks/abc200_e</a></p>
<p>
<script type="math/tex; mode=display">
0 \le i,j,k < N \tag{1}
</script>
ã“ã®ä¸ç­‰å¼ã‚’æº€ãŸã™$N^3$å€‹ã®æ•´æ•°ã®3ã¤çµ„$(i,j,k)$ã‚’ä»¥ä¸‹ã®é †åºã§ä¸¦ã¹ã‚‹ã€‚</p>
<ul>
<li>$i+j+k$ ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚</li>
<li>ã“ã“ã¾ã§ã§é †åºãŒã¤ã‹ãªã‘ã‚Œã°ã€$i$ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚</li>
<li>ã“ã“ã¾ã§ã§é †åºãŒã¤ã‹ãªã‘ã‚Œã°ã€$j$ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚</li>
</ul>
<p>ã“ã®ã¨ãã€å·¦ã‹ã‚‰$K$ç•ªç›®ã«ã‚ã‚‹æ•´æ•°ã®3ã¤çµ„$(i,j,k)$ã‚’ç­”ãˆãªã•ã„ã€‚</p>
<p>â€»æœ¬æ¥ã®å•é¡Œæ–‡ã§ã¯å¤‰æ•°ã®å‹•ãç¯„å›²ãŒ$1\le i,j,k \le N$ã§ã‚ã‚‹ã€‚
ã—ã‹ã—ãªãŒã‚‰<code>0-indexed</code>ã«ã™ã‚‹ã¨å®Ÿè£…ä¸Šéƒ½åˆãŒè‰¯ã„ã®ã§ã“ã®ã‚ˆã†ã«è¨€ã„æ›ãˆãŸã€‚
å…ƒã®å•é¡Œã«å¯¾ã—ã¦ã¯ä»Šå›å¾—ã‚‰ã‚ŒãŸè§£$(i^\ast, j^\ast, k^\ast)$ã‚’ç”¨ã„ã¦
$(i^\ast+1,j^\ast+1,k^\ast+1)$ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚
ä»¥é™ã“ã®ã‚ˆã†ã«å‹•ãå¤‰æ•°ã«å¯¾ã—ã¦å¾—ã‚‰ã‚ŒãŸ(å›ºå®šã•ã‚ŒãŸ)å¤‰æ•°ã‚’$\ast$ã‚’ã¤ã‘ã¦åŒºåˆ¥ã™ã‚‹ã€‚</p>
<h2 id="_2">åˆ¶ç´„</h2>
<ul>
<li>å…¥åŠ›ã¯å…¨ã¦æ•´æ•°</li>
<li>$1\le N \le 10^6$</li>
<li>$1\le K \le N^3$</li>
</ul>
<p>3ã¤çµ„$(i,j,k)$ã‚’$K$ç•ªç›®ã«åˆ°é”ã™ã‚‹ã¾ã§å°ã•ã„é †ã«åˆ—æŒ™ã™ã‚‹$O(N^3)ã®$æ„šç›´è§£ãŒã¾ãšæ€ã„ã¤ãã€‚
ã—ã‹ã—ã€ä»Šå›ã®åˆ¶ç´„ã§ã¯$O(N^3)$ã¯ãŠã‚ã‹$O(N^2)$ã™ã‚‰é€šã‚‰ãªã„ã€‚$O(N)$ã¾ã§è½ã¨ã™æ–¹æ³•ã‚’è€ƒãˆã‚‹ã€‚</p>
<h2 id="_3">æ–¹é‡ã€Œéšå±¤ã”ã¨ã«è§£å€™è£œã®å€‹æ•°ã‚’æ±‚ã‚ã€å–ã‚Šã¤ãã™ã€</h2>
<p>3ã¤çµ„$(i,j,k)$ã¯$i+j+k=l$ã®å€¤ã«ã‚ˆã£ã¦ã„ãã¤ã‹ã®éšå±¤ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚
ã“ã®éšå±¤ã¯ã„ãã¤ã‚ã‚‹ã ã‚ã†ã‹ã€ã¾ãš$l$ã®å–ã‚Šã†ã‚‹å€¤ã®ç¯„å›²ã‚’è€ƒãˆã‚‹ã€‚
$i=j=k=0$ã®ã¨ãã€æœ€å°å€¤$l=0$ã‚’å–ã‚Šã€
$i=j=k=N-1$ã®ã¨ãã€æœ€å¤§å€¤$l=3N-3$ã‚’å–ã‚‹ã€‚
ã¤ã¾ã‚Š$0\le l&lt;3N-2$ã®é–“ã®$3N-2$å€‹ã®å€¤ã‚’$l$ã¯æ¼ã‚Œãªãå–ã‚Šã†ã‚‹ã€‚</p>
<p>æ±‚ã‚ãŸã„$K$ç•ªç›®ã®3ã¤çµ„$(i,j,k)$ãŒã©ã®éšå±¤ã«å±ã—ã¦ã„ã‚‹ã‹ã‚’çŸ¥ã‚ŠãŸã„ã€‚
ãã®ãŸã‚ã«ã€æ™‚é–“è¨ˆç®—é‡$O(1)$ã§æ¬¡ã®å•ã„ã«ç­”ãˆã‚‹ã“ã¨ã®ã§ãã‚‹3ã¤ã®ã‚ªãƒ©ã‚¯ãƒ«ã®å­˜åœ¨ã‚’ä»®å®šã™ã‚‹ã€‚</p>
<ul>
<li>${\rm oracle_1}(l) :=$ã€Œ$l$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€</li>
<li>${\rm oracle_2}(l,i) :=$ã€Œ$l,i$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€</li>
<li>${\rm oracle_3}(l,i,j) :=$ã€Œ$l,i,j$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€</li>
</ul>
<p>${\rm oracle_1}(l)$ã‚’ç”¨ã„ã¦ç´¯ç©å’Œã®è€ƒãˆæ–¹ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€
<script type="math/tex; mode=display">
\sum_{l=1}^{l^{\ast}-1}{\rm oracle_1}(l) < K \le \sum_{l=1}^{l^{\ast}}{\rm oracle_1}(l)
</script>
ã‚’æº€ãŸã™$l^{\ast}$ã‚’æ™‚é–“è¨ˆç®—é‡$O(3N-2)=O(N)$ã§æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
ã“ã®çµæœã‹ã‚‰ã€$K$ç•ªç›®ã®3ã¤çµ„$(i,j,k)$ãŒéšå±¤$l^\ast$ã«å±ã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚</p>
<p>ã•ã¦ã€$l^\ast=i+j+k$ã‚’æº€ãŸã™è§£å€™è£œã¯æ„šç›´è§£ã‚ˆã‚Šã‚‚ã•ã‚‰ã«çµã‚Šè¾¼ã‚ãŸã€‚ã—ã‹ã—ãªãŒã‚‰ã€
ç¾æ™‚ç‚¹ã§å€™è£œã‚’åˆ—æŒ™ã™ã‚‹ã«ã¯$i$ã¨$j$ã®2ã¤ã®å¤‰æ•°ã‚’å‹•ã‹ã™å¿…è¦ãŒã‚ã‚Šã€$O(N^2)$ã®æ™‚é–“è¨ˆç®—é‡ãŒã‹ã‹ã£ã¦ã—ã¾ã†ã€‚
ãã“ã§ã•ã‚‰ã«${\rm oracle_2}(l, i)$ã‚’ç”¨ã„ã¦$O(N)$ã®æ™‚é–“ã‚’ã‹ã‘ã¦
ã‚ˆã‚Šç´°ã‹ã„ãµã‚‹ã„ã«ã‹ã‘ã‚‹ã‚ˆã†ã«è§£ã®å€™è£œã‚’çµã‚Šã“ã‚€æ–¹é‡ã‚’å–ã‚‹ã€‚</p>
<p>ä»¥é™ã®è­°è«–ã§ã¯$l^\ast$ã®éšå±¤ã®ä¸­ã§æ±‚ã‚ã‚‹è§£ãŒä½•ç•ªç›®ã§ã‚ã‚‹ã‹ã‚’çŸ¥ã‚Œã°ã‚ˆã„ã€‚
å¾“ã£ã¦ã€$l=1,2\cdots l^\ast-1$ã®è§£å€™è£œã¯ã‚‚ã†æ•°ãˆã‚ã’ã‚‹å¿…è¦ãŒç„¡ã„ãŸã‚æ¬¡ã®æ“ä½œã‚’è¡Œã£ã¦ã‚‚å•é¡Œãªã„ã€‚
<script type="math/tex; mode=display">
K' = K-\sum_{l=1}^{l^{\ast}-1}{\rm oracle_1}(l)
</script>
ä»¥ä¸Šã®æ“ä½œã‚’è¡Œã†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’Pythonã§æ›¸ãã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚</p>
<pre><code class="language-python">for l in range(0, 3*N-2):
    d = oracle1(l)
    if K-d &lt;= 0:
        break
    K -= d
</code></pre>
<p>å®Ÿéš›ã«${\rm oracle_2}(l, i)$ã‚’ç”¨ã„ã¦éšå±¤$l^\ast$ã®ä¸­ã§$K'$ç•ªç›®ã®3ã¤çµ„ã®$i$ã®å€¤$i^\ast$ã‚’è¨ˆç®—ã™ã‚‹ã®ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚
<script type="math/tex; mode=display">
\sum_{i=1}^{i^{\ast}-1}{\rm oracle_2}(l, i) < K' \le \sum_{i=1}^{i^{\ast}}{\rm oracle_2}(l, i) \\
K'' = K'-\sum_{i=1}^{i^{\ast}-1}{\rm oracle_2}(l, i)
</script>
</p>
<pre><code class="language-python">for i in range(0, N):
    d = oracle2(l, i)
    if K-d &lt;= 0:
        break
    K -= d
</code></pre>
<p>æœ€å¾Œã«${\rm oracle_3}(l, i, j)$ã‚’ç”¨ã„ã¦éšå±¤$l^\ast, i^\ast$ã®ä¸­ã§$K''$ç•ªç›®ã¾ã§ã®è§£å€™è£œã‚’ã™ã¹ã¦å–ã‚Šã¤ãã™ã€‚
<script type="math/tex; mode=display">
\sum_{j=1}^{j^{\ast}-1}{\rm oracle_3}(l, i, j) < K'' \le \sum_{j=1}^{j^{\ast}}{\rm oracle_3}(l, i, j) \\
K''' = K''-\sum_{j=1}^{j^{\ast}-1}{\rm oracle_3}(l, i, j)
</script>
</p>
<p>ã“ã®ã‚ˆã†ã«ã—ã¦å¾—ã‚‰ã‚ŒãŸ$l^\ast, i^\ast, j^\ast$ã‚’ç”¨ã„ã¦
<script type="math/tex; mode=display">
k^\ast = l^\ast - i^\ast - j^\ast
</script>
ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã§æ±‚ã‚ãŸã‹ã£ãŸ$K$ç•ªç›®ã®è§£$(i^\ast,j^\ast,k^\ast)$ã‚’ç­”ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚</p>
<pre><code class="language-python">for j in range(0, N):
    d = oracle3(l, i, j)
    if K-d &lt;= 0:
        break
    K -= d
</code></pre>
<h2 id="_4">ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ</h2>
<iframe src="../abc200_e_level.html" width=800 height=500></iframe>

<h3 id="rm-oracle_1l">${\rm oracle_1}(l)$</h3>
<p>ä¸Šè¨˜ã®ã‚°ãƒ©ãƒ•ã‚’å‹•ã‹ã—ã¦ã»ã—ã„ã€‚ğŸ”µã§ç¤ºã—ãŸåŒºé–“ã§ã¯ãƒ”ãƒ©ãƒŸãƒƒãƒ‰å½¢ã«ãªã£ã¦ãŠã‚Šã€
å„éšå±¤$l=0,1,2\cdots$ã®å€¤ã¯$1,3,6\cdots$ã¨ä¸€èˆ¬é …ã®ç°¡å˜ãªä¸‰è§’æ•°$\Sigma(l+1)$ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚</p>
<p>
<script type="math/tex; mode=display">\begin{align}
â€»\Sigma(n) = \sum_{i=1}^{n} i = \frac{n(n+1)}{2}
\end{align}</script>
</p>
<p>ğŸŸ¢ã§ç¤ºã—ãŸåŒºé–“ã§ã¯é€†ãƒ”ãƒ©ãƒŸãƒƒãƒ‰å½¢ã«ãªã£ã¦ãŠã‚Šã€é€†é †ã«æ¸›ã£ã¦ã„ããŸã‚
ä¸‰è§’æ•°ã®ä¸€èˆ¬é …ã«å¯¾ã—ã¦ $l \to 3N-3-l$
ã®å¤‰æ•°å¤‰æ›ã‚’ã™ã‚‹ã“ã¨ã§$\Sigma(3N-2-l)$ã¨å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚</p>
<p>é›£ã—ã„ã®ã¯ğŸ”´ã§ç¤ºã—ãŸåŒºé–“ã§ã‚ã‚‹ã€‚
$(N,0,0)$ã®ã‚ˆã†ã«åŒºé–“$[0,N)$ã«åã¾ã‚‰ãªã„æ•°ãŒå‡ºã¦ãã¦ã—ã¾ã†ã®ã ã€‚
ãã®ã‚ˆã†ãªå ´åˆã®æ•°ã‚’è€ƒãˆã€ä¸‰è§’æ•°ã‹ã‚‰æ¸›ãšã‚‹æ–¹é‡ã‚’å–ã‚‹ã€‚
ã¾ãšè£œé¡Œã¨ã—ã¦$i,j,k$ã®ä¸­ã§$N$ä»¥ä¸Šã®æ•°ã¯1ç¨®é¡ã®ã¿ã§ã‚ã‚‹ã€‚
ã“ã‚Œã¯ğŸ”´ã§ç¤ºã—ãŸåŒºé–“ã§æœ€å¤§ã®$l=2N-1$ã®æ™‚ã§ã‚‚ã€$(N,N-1,0)$ã®ã‚ˆã†ãª
ä¾‹ã—ã‹ä½œã‚Œãªã„ã“ã¨ã‹ã‚‰åˆ†ã‹ã‚‹ã€‚
ã™ãªã‚ã¡$N$ä»¥ä¸Šã®æ•°ã¨ã—ã¦$i,j,k$ã®ã©ã‚Œã‚’é¸ã¶ã‹ã§3é€šã‚Šã®è‡ªç”±åº¦ãŒã‚ã‚‹ã€‚
ä»¥é™ã¯$i$ã¨å›ºå®šã—ã¦å ´åˆã®æ•°ã‚’æ•°ãˆã‚‹ã€‚
$i$ãŒå–ã‚Šã†ã‚‹å€¤ã¯Nã‹ã‚‰lã¾ã§ã§ã‚ã‚Šã€$j$ãŒå–ã‚Šã†ã‚‹å€¤ã¯$0$ã‹ã‚‰$l-i$ã¾ã§ã®$l-i+1$é€šã‚Šã§ã‚ã‚‹ã€‚
$i,j$ãŒå®šã¾ã‚Œã°ã“ã®ç¯„å›²ã§$k$ãŒãŸã ä¸€ã¤ã«å®šã¾ã‚‹ã®ã§ã€æ±‚ã‚ã‚‹å ´åˆã®æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚
<script type="math/tex; mode=display">\begin{align}
\sum_{i=N}^{l} l-i+1
&= \sum_{i=l}^{N} i-(l+1) \\
&= \sum_{i=1}^{N-l+1} i \\
&= \Sigma(l+1-N)
\end{align}</script>
</p>
<p>ä»¥ä¸Šã®ğŸ”µğŸ”´ğŸŸ¢ã®3ã¤ã®åŒºé–“ã®çµæœã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ã§
${\rm oracle_1}(l)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã¾ã£ãŸã€‚
<script type="math/tex; mode=display">\begin{align}
{\rm oracle_1}(l) &= \begin{cases}
\Sigma(l+1)                & 0 \le l < N \\
\Sigma(l+1)-3\Sigma(l+1-N) & N \le l < 2N-2 \\
\Sigma(3N-2-l)             & 2N-2 \le l < 3N-2 \\
0                          & (otherwise)
\end{cases}
\end{align}</script>
</p>
<h3 id="rm-oracle_2l-i">${\rm oracle_2}(l, i)$</h3>
<p>$l,i$ã®å€¤ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹ã¨ãã€$j$ã‚’å®šã‚ã‚Œã°å¯¾å¿œã™ã‚‹$k$ã¯ãŸã $1$ã¤ã«å®šã¾ã‚‹ã€‚
å¾“ã£ã¦$j \in [L, U]$ã¨ä¸Šé™ã¨ä¸‹é™ãŒæ±‚ã¾ã‚Œã°ã€ãã®åŒºé–“ã®å¹…$\max(0, U-L+1)$å€‹ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚
ãªãœã€$\max(0,\cdot)$ã§åŒ…ã‚“ã§ã„ã‚‹ã®ã‹ã€ãã‚Œã¯
$[L, U]=\varnothing$ã¨ãªã‚‹å ´åˆã€
$L$ã¨$U$ã®æ±‚ã‚æ–¹ã«ã‚ˆã£ã¦ã¯$U-L&lt;0$ã¨ãªã‚Šã†ã‚‹ç‚ºã§ã‚ã‚‹ã€‚
å®Ÿéš›ã«ä¸Šé™$U$ã‚’æ±‚ã‚ã‚‹ã€‚$k=0$ã®æ™‚ã€æœ€å¤§å€¤$j=l-i$ã‚’å–ã‚‹ã€‚ãŸã ã—ã€$N-1$ã‚’ä¸Šå›ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã€
<script type="math/tex; mode=display">\begin{align}
U = \min(N-1, l-i)
\end{align}</script>
ã¨ãªã‚‹ã€‚
ã¾ãŸã€ä¸‹é™$L$ã‚’æ±‚ã‚ã‚‹ã€‚$k=N-1$ã®æ™‚ã€æœ€å°å€¤$j=l-i-(N-1)$ã‚’å–ã‚‹ã€‚ãŸã ã—ã€$0$ã‚’ä¸‹å›ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã€
<script type="math/tex; mode=display">\begin{align}
L = \max(0, l-i-(N-1))
\end{align}</script>
ä»¥ä¸Šã®çµæœã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ã§
${\rm oracle_2}(l, i)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã¾ã£ãŸã€‚
<script type="math/tex; mode=display">\begin{align}
{\rm oracle_2}(l, i) = \max(0, \min(N-1, l-i)-\max(0, l-i-(N-1))+1))
\end{align}</script>
</p>
<h3 id="rm-oracle_3l-i-j">${\rm oracle_3}(l, i, j)$</h3>
<p>å¾Œã¯ç°¡å˜ã§ã‚ã‚‹ã€ä¸ãˆã‚‰ã‚ŒãŸ$l,i,j$ã‹ã‚‰$k=l-i-j$ãŒãŸã $1$ã¤å®šã¾ã‚‹ãŸã‚ã€
$k$ãŒåŒºé–“$[0,N)$ã«åã¾ã£ã¦ã„ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€åã¾ã£ã¦ã„ã‚‹ãªã‚‰$1$å€‹ã€
åã¾ã£ã¦ã„ãªã‘ã‚Œã°$0$å€‹ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚</p>
<p>
<script type="math/tex; mode=display">\begin{align}
{\rm oracle_3}(l, i, j) = \begin{cases}
1 & 0 \le l-i-j < N \\
0 & (otherwise) \\
\end{cases}
\end{align}</script>
</p>
<h2 id="_5">å®Ÿè£…</h2>
<p>ä»¥ä¸Šã®è€ƒå¯Ÿã‚’è¸ã¾ãˆPythonã§å®Ÿè£…ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚</p>
<p>æå‡ºï¼š<a href="https://atcoder.jp/contests/abc200/submissions/22557207">https://atcoder.jp/contests/abc200/submissions/22557207</a></p>
<pre><code class="language-python">def sigma(n):
    return n*(n+1)//2

def oracle1(l):
    if l in range(0, N):
        return sigma(l+1)
    if l in range(N, 2*N-3+1):
        return sigma(l+1)-3*sigma(l+1-N)
    if l in range(2*N-3+1, 3*N-3+1):
        return sigma(3*N-2-l)
    return 0

def oracle2(l, i):
    L = max(0, l-i-(N-1))
    R = min(N-1, l-i)
    return max(0, R-L+1)

def oracle3(l, i, j):
    k = l - i - j
    if k in range(N):
        return 1
    return 0

N, K = map(int, input().split())
for l in range(0, 3*N-2):
    d = oracle1(l)
    if K-d &lt;= 0:
        break
    K -= d
for i in range(N):
    d = oracle2(l, i)
    if K-d &lt;= 0:
        break
    K -= d
for j in range(N):
    d = oracle3(l, i, j)
    if K-d &lt;= 0:
        break
    K -= d
k = l - i - j
print(i+1, j+1, k+1)
</code></pre>
<p>ã¾ãŸã€ã‚°ãƒ©ãƒ•ã®ä½œæˆã«ç”¨ã„ãŸã‚³ãƒ¼ãƒ‰ã‚‚å«ã‚ã¦ãŠãã€‚</p>
<pre><code class="language-python">import pandas as pd
import plotly.express as px
from itertools import product

N = 5

def level(l):
    if l in range(0, N):
        return &quot;0â‰¤l&lt;N&quot;
    if l in range(N, 2*N-2):
        return &quot;Nâ‰¤l&lt;2N-2&quot;
    if l in range(2*N-2, 3*N-2):
        return &quot;2N-2â‰¤l&lt;3N-2&quot;

df = pd.DataFrame(
    [
        [i,j,k,level(i+j+k)]
        for i,j,k in product(*[range(N)]*3)
    ],
    columns=['i','j','k','i+j+k=l']
)

fig = px.scatter_3d(
    df,
    x='i',
    y='j',
    z='k',
    color='i+j+k=l',
)

fig.update_layout(
    margin=dict(l=0,r=0,b=0,t=0),
    scene=dict(
        xaxis=dict(tickmode='linear',tick0=0,dtick=1),
        yaxis=dict(tickmode='linear',tick0=0,dtick=1),
        zaxis=dict(tickmode='linear',tick0=0,dtick=1),
    ),
    legend=dict(
        y=0.01,
        x=0.01,
    ),
)
fig.show()
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="ãƒ•ãƒƒã‚¿ãƒ¼">
      
        <a href="../abc186_d/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                å‰
              </span>
              ABC186-D Sum of difference
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+", "search.placeholder": "\u691c\u7d22", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044"}, "search": "../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.1d3bfcf1.min.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../javascripts/extra.js"></script>
      
    
  </body>
</html>