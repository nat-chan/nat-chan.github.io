
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.4">
    
    
      
        <title>ABC200-E Patisserie ABC 2 - ℕ</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#abc200-e-patisserie-abc-2" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href=".." title="ℕ" class="md-header__button md-logo" aria-label="ℕ" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ℕ
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ABC200-E Patisserie ABC 2
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="クリア" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ℕ" class="md-nav__button md-logo" aria-label="ℕ" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ℕ
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../abc186_d/" class="md-nav__link">
        ABC186-D Sum of difference
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ABC200-E Patisserie ABC 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ABC200-E Patisserie ABC 2
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tags-atcoder" class="md-nav__link">
    tags: atcoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    問題文
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    制約
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    方針「階層ごとに解候補の個数を求め、取りつくす」
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    オラクルの設計
  </a>
  
    <nav class="md-nav" aria-label="オラクルの設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rm-oracle_1l" class="md-nav__link">
    ${\rm oracle_1}(l)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_2l-i" class="md-nav__link">
    ${\rm oracle_2}(l, i)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_3l-i-j" class="md-nav__link">
    ${\rm oracle_3}(l, i, j)$
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    実装
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    関連する話題
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tags-atcoder" class="md-nav__link">
    tags: atcoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    問題文
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    制約
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    方針「階層ごとに解候補の個数を求め、取りつくす」
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    オラクルの設計
  </a>
  
    <nav class="md-nav" aria-label="オラクルの設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rm-oracle_1l" class="md-nav__link">
    ${\rm oracle_1}(l)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_2l-i" class="md-nav__link">
    ${\rm oracle_2}(l, i)$
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rm-oracle_3l-i-j" class="md-nav__link">
    ${\rm oracle_3}(l, i, j)$
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    実装
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    関連する話題
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="abc200-e-patisserie-abc-2">ABC200-E Patisserie ABC 2</h1>
<h6 id="tags-atcoder">tags: <code>atcoder</code></h6>
<h2 id="_1">問題文</h2>
<p>URL: <a href="https://atcoder.jp/contests/abc200/tasks/abc200_e">https://atcoder.jp/contests/abc200/tasks/abc200_e</a></p>
<p>
<script type="math/tex; mode=display">
0 \le i,j,k < N \tag{1}
</script>
この不等式を満たす$N^3$個の整数の3つ組$(i,j,k)$を以下の順序で並べる。</p>
<ul>
<li>$i+j+k$ が小さいものを、より左に並べる。</li>
<li>ここまでで順序がつかなければ、$i$が小さいものを、より左に並べる。</li>
<li>ここまでで順序がつかなければ、$j$が小さいものを、より左に並べる。</li>
</ul>
<p>このとき、左から$K$番目にある整数の3つ組$(i,j,k)$を答えなさい。</p>
<p>※本来の問題文では変数の動く範囲が$1\le i,j,k \le N$である。
しかしながら<code>0-indexed</code>にすると実装上都合が良いのでこのように言い換えた。
元の問題に対しては今回得られた解$(i^\ast, j^\ast, k^\ast)$を用いて
$(i^\ast+1,j^\ast+1,k^\ast+1)$を答えればよい。
以降このように動く変数に対して得られた(固定された)変数を$\ast$をつけて区別する。</p>
<h2 id="_2">制約</h2>
<ul>
<li>入力は全て整数</li>
<li>$1\le N \le 10^6$</li>
<li>$1\le K \le N^3$</li>
</ul>
<p>3つ組$(i,j,k)$を$K$番目に到達するまで小さい順に列挙する$O(N^3)の$愚直解がまず思いつく。
しかし、今回の制約では$O(N^3)$はおろか$O(N^2)$すら通らない。$O(N)$まで落とす方法を考える。</p>
<h2 id="_3">方針「階層ごとに解候補の個数を求め、取りつくす」</h2>
<p>3つ組$(i,j,k)$は$i+j+k=l$の値によっていくつかの階層に分けられる。
この階層はいくつあるだろうか、まず$l$の取りうる値の範囲を考える。
$i=j=k=0$のとき、最小値$l=0$を取り、
$i=j=k=N-1$のとき、最大値$l=3N-3$を取る。
つまり$0\le l&lt;3N-2$の間の$3N-2$個の値を$l$は漏れなく取りうる。</p>
<p>求めたい$K$番目の3つ組$(i,j,k)$がどの階層に属しているかを知りたい。
そのために、時間計算量$O(1)$で次の問いに答えることのできる3つのオラクルの存在を仮定する。</p>
<ul>
<li>${\rm oracle_1}(l) :=$「$l$が固定された時、(1)を満たす3つ組$(i,j,k)$の取りうる数」</li>
<li>${\rm oracle_2}(l,i) :=$「$l,i$が固定された時、(1)を満たす3つ組$(i,j,k)$の取りうる数」</li>
<li>${\rm oracle_3}(l,i,j) :=$「$l,i,j$が固定された時、(1)を満たす3つ組$(i,j,k)$の取りうる数」</li>
</ul>
<p>${\rm oracle_1}(l)$を用いて累積和の考え方を用いることで、
<script type="math/tex; mode=display">
\sum_{l=1}^{l^{\ast}-1}{\rm oracle_1}(l) < K \le \sum_{l=1}^{l^{\ast}}{\rm oracle_1}(l)
</script>
を満たす$l^{\ast}$を時間計算量$O(3N-2)=O(N)$で求めることができる。
この結果から、$K$番目の3つ組$(i,j,k)$が階層$l^\ast$に属していることが分かる。</p>
<p>さて、$l^\ast=i+j+k$を満たす解候補は愚直解よりもさらに絞り込めた。しかしながら、
現時点で候補を列挙するには$i$と$j$の2つの変数を動かす必要があり、$O(N^2)$の時間計算量がかかってしまう。
そこでさらに${\rm oracle_2}(l, i)$を用いて$O(N)$の時間をかけて
より細かいふるいにかけるように解の候補を絞りこむ方針を取る。</p>
<p>以降の議論では$l^\ast$の階層の中で求める解が何番目であるかを知ればよい。
従って、$l=1,2\cdots l^\ast-1$の解候補はもう数えあげる必要が無いため次の操作を行っても問題ない。
<script type="math/tex; mode=display">
K' = K-\sum_{l=1}^{l^{\ast}-1}{\rm oracle_1}(l)
</script>
以上の操作を行うアルゴリズムをPythonで書くと次のようになる。</p>
<pre><code class="language-python">for l in range(0, 3*N-2):
    d = oracle1(l)
    if K-d &lt;= 0:
        break
    K -= d
</code></pre>
<p>実際に${\rm oracle_2}(l, i)$を用いて階層$l^\ast$の中で$K'$番目の3つ組の$i$の値$i^\ast$を計算するのは以下のようになる。</p>
<p>
<script type="math/tex; mode=display">
\sum_{i=1}^{i^{\ast}-1}{\rm oracle_2}(l, i) < K' \le \sum_{i=1}^{i^{\ast}}{\rm oracle_2}(l, i) \\
K'' = K'-\sum_{i=1}^{i^{\ast}-1}{\rm oracle_2}(l, i)
</script>
</p>
<pre><code class="language-python">for i in range(0, N):
    d = oracle2(l, i)
    if K-d &lt;= 0:
        break
    K -= d
</code></pre>
<p>最後に${\rm oracle_3}(l, i, j)$を用いて階層$l^\ast, i^\ast$の中で$K''$番目までの解候補をすべて取りつくす。
<script type="math/tex; mode=display">
\sum_{j=1}^{j^{\ast}-1}{\rm oracle_3}(l, i, j) < K'' \le \sum_{j=1}^{j^{\ast}}{\rm oracle_3}(l, i, j) \\
K''' = K''-\sum_{j=1}^{j^{\ast}-1}{\rm oracle_3}(l, i, j)
</script>
</p>
<p>このようにして得られた$l^\ast, i^\ast, j^\ast$を用いて
<script type="math/tex; mode=display">
k^\ast = l^\ast - i^\ast - j^\ast
</script>
を計算することで求めたかった$K$番目の解$(i^\ast,j^\ast,k^\ast)$を答えることができる。</p>
<pre><code class="language-python">for j in range(0, N):
    d = oracle3(l, i, j)
    if K-d &lt;= 0:
        break
    K -= d
</code></pre>
<h2 id="_4">オラクルの設計</h2>
<iframe src="../abc200_e_level.html" width=800 height=500></iframe>

<h3 id="rm-oracle_1l">${\rm oracle_1}(l)$</h3>
<p>上記のグラフを動かしてほしい。🔵で示した区間ではピラミッド形になっており、
各階層$l=0,1,2\cdots$の値は$1,3,6\cdots$と一般項の簡単な三角数$\Sigma(l+1)$であることが分かる。</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
※\Sigma(n) = \sum_{i=1}^{n} i = \frac{n(n+1)}{2}
\end{align}
</script>
</p>
<p>🟢で示した区間では逆ピラミッド形になっており、逆順に減っていくため
三角数の一般項に対して $l \to 3N-3-l$
の変数変換をすることで$\Sigma(3N-2-l)$と得ることができる。</p>
<p>難しいのは🔴で示した区間である。
$(N,0,0)$のように区間$[0,N)$に収まらない数が出てきてしまうのだ。
そのような場合の数を考え、三角数から減ずる方針を取る。
まず補題として$i,j,k$の中で$N$以上の数は1種類のみである。
これは🔴で示した区間で最大の$l=2N-1$の時でも、$(N,N-1,0)$のような
例しか作れないことから分かる。
すなわち$N$以上の数として$i,j,k$のどれを選ぶかで3通りの自由度がある。
以降は$i$と固定して場合の数を数える。
$i$が取りうる値はNからlまでであり、$j$が取りうる値は$0$から$l-i$までの$l-i+1$通りである。
$i,j$が定まればこの範囲で$k$がただ一つに定まるので、求める場合の数は以下のようになる。</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
\sum_{i=N}^{l} l-i+1
&= \sum_{i=l}^{N} i-(l+1) \\
&= \sum_{i=1}^{N-l+1} i \\
&= \Sigma(l+1-N)
\end{align}
</script>
</p>
<p>以上の🔵🔴🟢の3つの区間の結果をまとめることで
${\rm oracle_1}(l)$は以下のように定まった。</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
{\rm oracle_1}(l) &= \begin{cases}
\Sigma(l+1)                & 0 \le l < N \\
\Sigma(l+1)-3\Sigma(l+1-N) & N \le l < 2N-2 \\
\Sigma(3N-2-l)             & 2N-2 \le l < 3N-2 \\
0                          & (otherwise)
\end{cases}
\end{align}
</script>
</p>
<h3 id="rm-oracle_2l-i">${\rm oracle_2}(l, i)$</h3>
<p>$l,i$の値が与えられているとき、$j$を定めれば対応する$k$はただ$1$つに定まる。
従って$j \in [L, U]$と上限と下限が求まれば、その区間の幅$\max(0, U-L+1)$個を答えればよい。
なぜ、$\max(0,\cdot)$で包んでいるのか、それは
$[L, U]=\varnothing$となる場合、
$L$と$U$の求め方によっては$U-L&lt;0$となりうる為である。
実際に上限$U$を求める。$k=0$の時、最大値$j=l-i$を取る。ただし、$N-1$を上回ることはないので、</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
U = \min(N-1, l-i)
\end{align}
</script>
</p>
<p>となる。
また、下限$L$を求める。$k=N-1$の時、最小値$j=l-i-(N-1)$を取る。ただし、$0$を下回ることはないので、
<script type="math/tex; mode=display">
\begin{align}
L = \max(0, l-i-(N-1))
\end{align}
</script>
</p>
<p>以上の結果をまとめることで
${\rm oracle_2}(l, i)$は以下のように定まった。</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
{\rm oracle_2}(l, i) = \max(0, \min(N-1, l-i)-\max(0, l-i-(N-1))+1))
\end{align}
</script>
</p>
<h3 id="rm-oracle_3l-i-j">${\rm oracle_3}(l, i, j)$</h3>
<p>後は簡単である、与えられた$l,i,j$から$k=l-i-j$がただ$1$つ定まるため、
$k$が区間$[0,N)$に収まっているかをチェックし、収まっているなら$1$個、
収まっていなければ$0$個を答えればよい。</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
{\rm oracle_3}(l, i, j) = \begin{cases}
1 & 0 \le l-i-j < N \\
0 & (otherwise) \\
\end{cases}
\end{align}
</script>
</p>
<h2 id="_5">実装</h2>
<p>以上の考察を踏まえPythonで実装したコードを以下に示す。</p>
<p>提出：<a href="https://atcoder.jp/contests/abc200/submissions/22557207">https://atcoder.jp/contests/abc200/submissions/22557207</a></p>
<pre><code class="language-python">def sigma(n):
    return n*(n+1)//2

def oracle1(l):
    if l in range(0, N):
        return sigma(l+1)
    if l in range(N, 2*N-3+1):
        return sigma(l+1)-3*sigma(l+1-N)
    if l in range(2*N-3+1, 3*N-3+1):
        return sigma(3*N-2-l)
    return 0

def oracle2(l, i):
    L = max(0, l-i-(N-1))
    R = min(N-1, l-i)
    return max(0, R-L+1)

def oracle3(l, i, j):
    k = l - i - j
    if k in range(N):
        return 1
    return 0

N, K = map(int, input().split())
for l in range(0, 3*N-2):
    d = oracle1(l)
    if K-d &lt;= 0:
        break
    K -= d
for i in range(N):
    d = oracle2(l, i)
    if K-d &lt;= 0:
        break
    K -= d
for j in range(N):
    d = oracle3(l, i, j)
    if K-d &lt;= 0:
        break
    K -= d
k = l - i - j
print(i+1, j+1, k+1)
</code></pre>
<p>また、グラフの作成に用いたコードも含めておく。</p>
<pre><code class="language-python">import pandas as pd
import plotly.express as px
from itertools import product

N = 5

def level(l):
    if l in range(0, N):
        return &quot;0≤l&lt;N&quot;
    if l in range(N, 2*N-2):
        return &quot;N≤l&lt;2N-2&quot;
    if l in range(2*N-2, 3*N-2):
        return &quot;2N-2≤l&lt;3N-2&quot;

df = pd.DataFrame(
    [
        [i,j,k,level(i+j+k)]
        for i,j,k in product(*[range(N)]*3)
    ],
    columns=['i','j','k','i+j+k=l']
)

fig = px.scatter_3d(
    df,
    x='i',
    y='j',
    z='k',
    color='i+j+k=l',
)

fig.update_layout(
    margin=dict(l=0,r=0,b=0,t=0),
    scene=dict(
        xaxis=dict(tickmode='linear',tick0=0,dtick=1),
        yaxis=dict(tickmode='linear',tick0=0,dtick=1),
        zaxis=dict(tickmode='linear',tick0=0,dtick=1),
    ),
    legend=dict(
        y=0.01,
        x=0.01,
    ),
)
fig.show()
</code></pre>
<h2 id="_6">関連する話題</h2>
<p>今回の問題は<strong>K番目に小さい数を求める</strong>という典型問題の一つで、青diff程度の難易度であったが、</p>
<p><a href="https://atcoder.jp/contests/abc200/tasks/abc200_e"><span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #0000FF; background: linear-gradient(to top, #0000FF 0%, #0000FF 88.75%, rgba(0, 0, 0, 0) 88.75%, rgba(0, 0, 0, 0) 100%); "></span> ABC200-E Patisserie ABC 2</a></p>
<p>同様の考え方で解ける。緑diffの練習問題として次の問題がある。</p>
<p><a href="https://atcoder.jp/contests/abc061/tasks/abc061_c"><span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #008000; background: linear-gradient(to top, #008000 0%, #008000 2%, rgba(0, 0, 0, 0) 2%, rgba(0, 0, 0, 0) 100%); "></span> ABC061-C Big Array</a></p>
<p>ABC200の節目を記念してABC100のオマージュ問題として出題されたようだ。</p>
<p><a href="https://atcoder.jp/contests/abc100/tasks/abc100_d"><span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #00C0C0; background: linear-gradient(to top, #00C0C0 0%, #00C0C0 32.75%, rgba(0, 0, 0, 0) 32.75%, rgba(0, 0, 0, 0) 100%); "></span> ABC100-D Patisserie ABC</a></p>
<p>また、<a href="https://atcoder.jp/contests/abc200/editorial/1247">physics0523による解説</a>
によるとボーナス問題としてより大きい制約で解くことが問われる。今回の方針を拡張し、オラクルの累積和を代数的に求めたのちに2分探索を用いることで$O(\log N)$で解ける。</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="フッター">
      
        <a href="../abc186_d/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                前
              </span>
              ABC186-D Sum of difference
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+", "search.placeholder": "\u691c\u7d22", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044"}, "search": "../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.1d3bfcf1.min.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../javascripts/extra.js"></script>
      
    
  </body>
</html>