# ABC200-E Patisserie ABC 2
###### tags: `atcoder`
## å•é¡Œæ–‡
URL: https://atcoder.jp/contests/abc200/tasks/abc200_e

$$
0 \le i,j,k < N \tag{1}
$$
ã“ã®ä¸ç­‰å¼ã‚’æº€ãŸã™$N^3$å€‹ã®æ•´æ•°ã®3ã¤çµ„$(i,j,k)$ã‚’ä»¥ä¸‹ã®é †åºã§ä¸¦ã¹ã‚‹ã€‚

- $i+j+k$ ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚
- ã“ã“ã¾ã§ã§é †åºãŒã¤ã‹ãªã‘ã‚Œã°ã€$i$ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚
- ã“ã“ã¾ã§ã§é †åºãŒã¤ã‹ãªã‘ã‚Œã°ã€$j$ãŒå°ã•ã„ã‚‚ã®ã‚’ã€ã‚ˆã‚Šå·¦ã«ä¸¦ã¹ã‚‹ã€‚

ã“ã®ã¨ãã€å·¦ã‹ã‚‰$K$ç•ªç›®ã«ã‚ã‚‹æ•´æ•°ã®3ã¤çµ„$(i,j,k)$ã‚’ç­”ãˆãªã•ã„ã€‚

â€»æœ¬æ¥ã®å•é¡Œæ–‡ã§ã¯å¤‰æ•°ã®å‹•ãç¯„å›²ãŒ$1\le i,j,k \le N$ã§ã‚ã‚‹ã€‚
ã—ã‹ã—ãªãŒã‚‰`0-indexed`ã«ã™ã‚‹ã¨å®Ÿè£…ä¸Šéƒ½åˆãŒè‰¯ã„ã®ã§ã“ã®ã‚ˆã†ã«è¨€ã„æ›ãˆãŸã€‚
å…ƒã®å•é¡Œã«å¯¾ã—ã¦ã¯ä»Šå›å¾—ã‚‰ã‚ŒãŸè§£$(i^\ast, j^\ast, k^\ast)$ã‚’ç”¨ã„ã¦
$(i^\ast+1,j^\ast+1,k^\ast+1)$ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚
ä»¥é™ã“ã®ã‚ˆã†ã«å‹•ãå¤‰æ•°ã«å¯¾ã—ã¦å¾—ã‚‰ã‚ŒãŸ(å›ºå®šã•ã‚ŒãŸ)å¤‰æ•°ã‚’$\ast$ã‚’ã¤ã‘ã¦åŒºåˆ¥ã™ã‚‹ã€‚

## åˆ¶ç´„
- å…¥åŠ›ã¯å…¨ã¦æ•´æ•°
- $1\le N \le 10^6$
- $1\le K \le N^3$

3ã¤çµ„$(i,j,k)$ã‚’$K$ç•ªç›®ã«åˆ°é”ã™ã‚‹ã¾ã§å°ã•ã„é †ã«åˆ—æŒ™ã™ã‚‹$O(N^3)ã®$æ„šç›´è§£ãŒã¾ãšæ€ã„ã¤ãã€‚
ã—ã‹ã—ã€ä»Šå›ã®åˆ¶ç´„ã§ã¯$O(N^3)$ã¯ãŠã‚ã‹$O(N^2)$ã™ã‚‰é€šã‚‰ãªã„ã€‚$O(N)$ã¾ã§è½ã¨ã™æ–¹æ³•ã‚’è€ƒãˆã‚‹ã€‚

## æ–¹é‡ã€Œéšå±¤ã”ã¨ã«è§£å€™è£œã®å€‹æ•°ã‚’æ±‚ã‚ã€å–ã‚Šã¤ãã™ã€

3ã¤çµ„$(i,j,k)$ã¯$i+j+k=l$ã®å€¤ã«ã‚ˆã£ã¦ã„ãã¤ã‹ã®éšå±¤ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚
ã“ã®éšå±¤ã¯ã„ãã¤ã‚ã‚‹ã ã‚ã†ã‹ã€ã¾ãš$l$ã®å–ã‚Šã†ã‚‹å€¤ã®ç¯„å›²ã‚’è€ƒãˆã‚‹ã€‚
$i=j=k=0$ã®ã¨ãã€æœ€å°å€¤$l=0$ã‚’å–ã‚Šã€
$i=j=k=N-1$ã®ã¨ãã€æœ€å¤§å€¤$l=3N-3$ã‚’å–ã‚‹ã€‚
ã¤ã¾ã‚Š$0\le l<3N-2$ã®é–“ã®$3N-2$å€‹ã®å€¤ã‚’$l$ã¯æ¼ã‚Œãªãå–ã‚Šã†ã‚‹ã€‚

æ±‚ã‚ãŸã„$K$ç•ªç›®ã®3ã¤çµ„$(i,j,k)$ãŒã©ã®éšå±¤ã«å±ã—ã¦ã„ã‚‹ã‹ã‚’çŸ¥ã‚ŠãŸã„ã€‚
ãã®ãŸã‚ã«ã€æ™‚é–“è¨ˆç®—é‡$O(1)$ã§æ¬¡ã®å•ã„ã«ç­”ãˆã‚‹ã“ã¨ã®ã§ãã‚‹3ã¤ã®ã‚ªãƒ©ã‚¯ãƒ«ã®å­˜åœ¨ã‚’ä»®å®šã™ã‚‹ã€‚

- ${\rm oracle_1}(l) :=$ã€Œ$l$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€
- ${\rm oracle_2}(l,i) :=$ã€Œ$l,i$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€
- ${\rm oracle_3}(l,i,j) :=$ã€Œ$l,i,j$ãŒå›ºå®šã•ã‚ŒãŸæ™‚ã€(1)ã‚’æº€ãŸã™3ã¤çµ„$(i,j,k)$ã®å–ã‚Šã†ã‚‹æ•°ã€

${\rm oracle_1}(l)$ã‚’ç”¨ã„ã¦ç´¯ç©å’Œã®è€ƒãˆæ–¹ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€
$$
\sum_{l=1}^{l^{\ast}-1}{\rm oracle_1}(l) < K \le \sum_{l=1}^{l^{\ast}}{\rm oracle_1}(l)
$$
ã‚’æº€ãŸã™$l^{\ast}$ã‚’æ™‚é–“è¨ˆç®—é‡$O(3N-2)=O(N)$ã§æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
ã“ã®çµæœã‹ã‚‰ã€$K$ç•ªç›®ã®3ã¤çµ„$(i,j,k)$ãŒéšå±¤$l^\ast$ã«å±ã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚

ã•ã¦ã€$l^\ast=i+j+k$ã‚’æº€ãŸã™è§£å€™è£œã¯æ„šç›´è§£ã‚ˆã‚Šã‚‚ã•ã‚‰ã«çµã‚Šè¾¼ã‚ãŸã€‚ã—ã‹ã—ãªãŒã‚‰ã€
ç¾æ™‚ç‚¹ã§å€™è£œã‚’åˆ—æŒ™ã™ã‚‹ã«ã¯$i$ã¨$j$ã®2ã¤ã®å¤‰æ•°ã‚’å‹•ã‹ã™å¿…è¦ãŒã‚ã‚Šã€$O(N^2)$ã®æ™‚é–“è¨ˆç®—é‡ãŒã‹ã‹ã£ã¦ã—ã¾ã†ã€‚
ãã“ã§ã•ã‚‰ã«${\rm oracle_2}(l, i)$ã‚’ç”¨ã„ã¦$O(N)$ã®æ™‚é–“ã‚’ã‹ã‘ã¦
ã‚ˆã‚Šç´°ã‹ã„ãµã‚‹ã„ã«ã‹ã‘ã‚‹ã‚ˆã†ã«è§£ã®å€™è£œã‚’çµã‚Šã“ã‚€æ–¹é‡ã‚’å–ã‚‹ã€‚

ä»¥é™ã®è­°è«–ã§ã¯$l^\ast$ã®éšå±¤ã®ä¸­ã§æ±‚ã‚ã‚‹è§£ãŒä½•ç•ªç›®ã§ã‚ã‚‹ã‹ã‚’çŸ¥ã‚Œã°ã‚ˆã„ã€‚
å¾“ã£ã¦ã€$l=1,2\cdots l^\ast-1$ã®è§£å€™è£œã¯ã‚‚ã†æ•°ãˆã‚ã’ã‚‹å¿…è¦ãŒç„¡ã„ãŸã‚æ¬¡ã®æ“ä½œã‚’è¡Œã£ã¦ã‚‚å•é¡Œãªã„ã€‚
$$
K' = K-\sum_{l=1}^{l^{\ast}-1}{\rm oracle_1}(l)
$$
ä»¥ä¸Šã®æ“ä½œã‚’è¡Œã†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’Pythonã§æ›¸ãã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

```python linenums="1"
for l in range(0, 3*N-2):
    d = oracle1(l)
    if K-d <= 0:
        break
    K -= d
```

å®Ÿéš›ã«${\rm oracle_2}(l, i)$ã‚’ç”¨ã„ã¦éšå±¤$l^\ast$ã®ä¸­ã§$K'$ç•ªç›®ã®3ã¤çµ„ã®$i$ã®å€¤$i^\ast$ã‚’è¨ˆç®—ã™ã‚‹ã®ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚

$$
\sum_{i=1}^{i^{\ast}-1}{\rm oracle_2}(l, i) < K' \le \sum_{i=1}^{i^{\ast}}{\rm oracle_2}(l, i) \\
K'' = K'-\sum_{i=1}^{i^{\ast}-1}{\rm oracle_2}(l, i)
$$

```python linenums="6"
for i in range(0, N):
    d = oracle2(l, i)
    if K-d <= 0:
        break
    K -= d
```

æœ€å¾Œã«${\rm oracle_3}(l, i, j)$ã‚’ç”¨ã„ã¦éšå±¤$l^\ast, i^\ast$ã®ä¸­ã§$K''$ç•ªç›®ã¾ã§ã®è§£å€™è£œã‚’ã™ã¹ã¦å–ã‚Šã¤ãã™ã€‚
$$
\sum_{j=1}^{j^{\ast}-1}{\rm oracle_3}(l, i, j) < K'' \le \sum_{j=1}^{j^{\ast}}{\rm oracle_3}(l, i, j) \\
K''' = K''-\sum_{j=1}^{j^{\ast}-1}{\rm oracle_3}(l, i, j)
$$

ã“ã®ã‚ˆã†ã«ã—ã¦å¾—ã‚‰ã‚ŒãŸ$l^\ast, i^\ast, j^\ast$ã‚’ç”¨ã„ã¦
$$
k^\ast = l^\ast - i^\ast - j^\ast
$$
ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã§æ±‚ã‚ãŸã‹ã£ãŸ$K$ç•ªç›®ã®è§£$(i^\ast,j^\ast,k^\ast)$ã‚’ç­”ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

```python linenums="11"
for j in range(0, N):
    d = oracle3(l, i, j)
    if K-d <= 0:
        break
    K -= d
```

## ã‚ªãƒ©ã‚¯ãƒ«ã®è¨­è¨ˆ

<iframe src="../abc200_e_level.html" width=800 height=500></iframe>

### ${\rm oracle_1}(l)$

ä¸Šè¨˜ã®ã‚°ãƒ©ãƒ•ã‚’å‹•ã‹ã—ã¦ã»ã—ã„ã€‚ğŸ”µã§ç¤ºã—ãŸåŒºé–“ã§ã¯ãƒ”ãƒ©ãƒŸãƒƒãƒ‰å½¢ã«ãªã£ã¦ãŠã‚Šã€
å„éšå±¤$l=0,1,2\cdots$ã®å€¤ã¯$1,3,6\cdots$ã¨ä¸€èˆ¬é …ã®ç°¡å˜ãªä¸‰è§’æ•°$\Sigma(l+1)$ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚

$$
\begin{align}
â€»\Sigma(n) = \sum_{i=1}^{n} i = \frac{n(n+1)}{2}
\end{align}
$$

ğŸŸ¢ã§ç¤ºã—ãŸåŒºé–“ã§ã¯é€†ãƒ”ãƒ©ãƒŸãƒƒãƒ‰å½¢ã«ãªã£ã¦ãŠã‚Šã€é€†é †ã«æ¸›ã£ã¦ã„ããŸã‚
ä¸‰è§’æ•°ã®ä¸€èˆ¬é …ã«å¯¾ã—ã¦ $l \to 3N-3-l$
ã®å¤‰æ•°å¤‰æ›ã‚’ã™ã‚‹ã“ã¨ã§$\Sigma(3N-2-l)$ã¨å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

é›£ã—ã„ã®ã¯ğŸ”´ã§ç¤ºã—ãŸåŒºé–“ã§ã‚ã‚‹ã€‚
$(N,0,0)$ã®ã‚ˆã†ã«åŒºé–“$[0,N)$ã«åã¾ã‚‰ãªã„æ•°ãŒå‡ºã¦ãã¦ã—ã¾ã†ã®ã ã€‚
ãã®ã‚ˆã†ãªå ´åˆã®æ•°ã‚’è€ƒãˆã€ä¸‰è§’æ•°ã‹ã‚‰æ¸›ãšã‚‹æ–¹é‡ã‚’å–ã‚‹ã€‚
ã¾ãšè£œé¡Œã¨ã—ã¦$i,j,k$ã®ä¸­ã§$N$ä»¥ä¸Šã®æ•°ã¯1ç¨®é¡ã®ã¿ã§ã‚ã‚‹ã€‚
ã“ã‚Œã¯ğŸ”´ã§ç¤ºã—ãŸåŒºé–“ã§æœ€å¤§ã®$l=2N-1$ã®æ™‚ã§ã‚‚ã€$(N,N-1,0)$ã®ã‚ˆã†ãª
ä¾‹ã—ã‹ä½œã‚Œãªã„ã“ã¨ã‹ã‚‰åˆ†ã‹ã‚‹ã€‚
ã™ãªã‚ã¡$N$ä»¥ä¸Šã®æ•°ã¨ã—ã¦$i,j,k$ã®ã©ã‚Œã‚’é¸ã¶ã‹ã§3é€šã‚Šã®è‡ªç”±åº¦ãŒã‚ã‚‹ã€‚
ä»¥é™ã¯$i$ã¨å›ºå®šã—ã¦å ´åˆã®æ•°ã‚’æ•°ãˆã‚‹ã€‚
$i$ãŒå–ã‚Šã†ã‚‹å€¤ã¯Nã‹ã‚‰lã¾ã§ã§ã‚ã‚Šã€$j$ãŒå–ã‚Šã†ã‚‹å€¤ã¯$0$ã‹ã‚‰$l-i$ã¾ã§ã®$l-i+1$é€šã‚Šã§ã‚ã‚‹ã€‚
$i,j$ãŒå®šã¾ã‚Œã°ã“ã®ç¯„å›²ã§$k$ãŒãŸã ä¸€ã¤ã«å®šã¾ã‚‹ã®ã§ã€æ±‚ã‚ã‚‹å ´åˆã®æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚

$$
\begin{align}
\sum_{i=N}^{l} l-i+1
&= \sum_{i=l}^{N} i-(l+1) \\
&= \sum_{i=1}^{N-l+1} i \\
&= \Sigma(l+1-N)
\end{align}
$$

ä»¥ä¸Šã®ğŸ”µğŸ”´ğŸŸ¢ã®3ã¤ã®åŒºé–“ã®çµæœã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ã§
${\rm oracle_1}(l)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã¾ã£ãŸã€‚

$$
\begin{align}
{\rm oracle_1}(l) &= \begin{cases}
\Sigma(l+1)                & 0 \le l < N \\
\Sigma(l+1)-3\Sigma(l+1-N) & N \le l < 2N-2 \\
\Sigma(3N-2-l)             & 2N-2 \le l < 3N-2 \\
0                          & (otherwise)
\end{cases}
\end{align}
$$

### ${\rm oracle_2}(l, i)$
$l,i$ã®å€¤ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹ã¨ãã€$j$ã‚’å®šã‚ã‚Œã°å¯¾å¿œã™ã‚‹$k$ã¯ãŸã $1$ã¤ã«å®šã¾ã‚‹ã€‚
å¾“ã£ã¦$j \in [L, U]$ã¨ä¸Šé™ã¨ä¸‹é™ãŒæ±‚ã¾ã‚Œã°ã€ãã®åŒºé–“ã®å¹…$\max(0, U-L+1)$å€‹ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚
ãªãœã€$\max(0,\cdot)$ã§åŒ…ã‚“ã§ã„ã‚‹ã®ã‹ã€ãã‚Œã¯
$[L, U]=\varnothing$ã¨ãªã‚‹å ´åˆã€
$L$ã¨$U$ã®æ±‚ã‚æ–¹ã«ã‚ˆã£ã¦ã¯$U-L<0$ã¨ãªã‚Šã†ã‚‹ç‚ºã§ã‚ã‚‹ã€‚
å®Ÿéš›ã«ä¸Šé™$U$ã‚’æ±‚ã‚ã‚‹ã€‚$k=0$ã®æ™‚ã€æœ€å¤§å€¤$j=l-i$ã‚’å–ã‚‹ã€‚ãŸã ã—ã€$N-1$ã‚’ä¸Šå›ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã€

$$
\begin{align}
U = \min(N-1, l-i)
\end{align}
$$

ã¨ãªã‚‹ã€‚
ã¾ãŸã€ä¸‹é™$L$ã‚’æ±‚ã‚ã‚‹ã€‚$k=N-1$ã®æ™‚ã€æœ€å°å€¤$j=l-i-(N-1)$ã‚’å–ã‚‹ã€‚ãŸã ã—ã€$0$ã‚’ä¸‹å›ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã€
$$
\begin{align}
L = \max(0, l-i-(N-1))
\end{align}
$$

ä»¥ä¸Šã®çµæœã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ã§
${\rm oracle_2}(l, i)$ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã¾ã£ãŸã€‚

$$
\begin{align}
{\rm oracle_2}(l, i) = \max(0, \min(N-1, l-i)-\max(0, l-i-(N-1))+1))
\end{align}
$$

### ${\rm oracle_3}(l, i, j)$
å¾Œã¯ç°¡å˜ã§ã‚ã‚‹ã€ä¸ãˆã‚‰ã‚ŒãŸ$l,i,j$ã‹ã‚‰$k=l-i-j$ãŒãŸã $1$ã¤å®šã¾ã‚‹ãŸã‚ã€
$k$ãŒåŒºé–“$[0,N)$ã«åã¾ã£ã¦ã„ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€åã¾ã£ã¦ã„ã‚‹ãªã‚‰$1$å€‹ã€
åã¾ã£ã¦ã„ãªã‘ã‚Œã°$0$å€‹ã‚’ç­”ãˆã‚Œã°ã‚ˆã„ã€‚

$$
\begin{align}
{\rm oracle_3}(l, i, j) = \begin{cases}
1 & 0 \le l-i-j < N \\
0 & (otherwise) \\
\end{cases}
\end{align}
$$

## é–¢é€£ã™ã‚‹è©±é¡Œ

ä»Šå›ã®å•é¡Œã¯**Kç•ªç›®ã«å°ã•ã„æ•°ã‚’æ±‚ã‚ã‚‹**ã¨ã„ã†å…¸å‹å•é¡Œã®ä¸€ã¤ã§ã€é’diffç¨‹åº¦ã®é›£æ˜“åº¦ã§ã‚ã£ãŸãŒã€

[<span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #0000FF; background: linear-gradient(to top, #0000FF 0%, #0000FF 88.75%, rgba(0, 0, 0, 0) 88.75%, rgba(0, 0, 0, 0) 100%); "></span> ABC200-E Patisserie ABC 2](https://atcoder.jp/contests/abc200/tasks/abc200_e)

åŒæ§˜ã®è€ƒãˆæ–¹ã§è§£ã‘ã‚‹ã€‚ç·‘diffã®ç·´ç¿’å•é¡Œã¨ã—ã¦æ¬¡ã®å•é¡ŒãŒã‚ã‚‹ã€‚

[<span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #008000; background: linear-gradient(to top, #008000 0%, #008000 2%, rgba(0, 0, 0, 0) 2%, rgba(0, 0, 0, 0) 100%); "></span> ABC061-C Big Array](https://atcoder.jp/contests/abc061/tasks/abc061_c)

ABC200ã®ç¯€ç›®ã‚’è¨˜å¿µã—ã¦ABC100ã®ã‚ªãƒãƒ¼ã‚¸ãƒ¥å•é¡Œã¨ã—ã¦å‡ºé¡Œã•ã‚ŒãŸã‚ˆã†ã ã€‚

[<span style="display: inline-block; border-radius: 50%; border-style: solid;border-width: 3px; margin-right: 5px; vertical-align: initial; height: 36px; width: 36px;border-color: #00C0C0; background: linear-gradient(to top, #00C0C0 0%, #00C0C0 32.75%, rgba(0, 0, 0, 0) 32.75%, rgba(0, 0, 0, 0) 100%); "></span> ABC100-D Patisserie ABC](https://atcoder.jp/contests/abc100/tasks/abc100_d)

ã¾ãŸã€[physics0523ã«ã‚ˆã‚‹è§£èª¬](https://atcoder.jp/contests/abc200/editorial/1247)
ã«ã‚ˆã‚‹ã¨ãƒœãƒ¼ãƒŠã‚¹å•é¡Œã¨ã—ã¦ã‚ˆã‚Šå¤§ãã„åˆ¶ç´„ã§è§£ãã“ã¨ãŒå•ã‚ã‚Œã‚‹ã€‚ä»Šå›ã®æ–¹é‡ã‚’æ‹¡å¼µã—ã€ã‚ªãƒ©ã‚¯ãƒ«ã®ç´¯ç©å’Œã‚’ä»£æ•°çš„ã«æ±‚ã‚ãŸã®ã¡ã«2åˆ†æ¢ç´¢ã‚’ç”¨ã„ã‚‹ã“ã¨ã§$O(\log N)$ã§è§£ã‘ã‚‹ã€‚

## å®Ÿè£…

ä»¥ä¸Šã®è€ƒå¯Ÿã‚’è¸ã¾ãˆPythonã§å®Ÿè£…ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚

æå‡ºï¼š[https://atcoder.jp/contests/abc200/submissions/22557207](https://atcoder.jp/contests/abc200/submissions/22557207)

```python linenums="1"
def sigma(n):
    return n*(n+1)//2

def oracle1(l):
    if l in range(0, N):
        return sigma(l+1)
    if l in range(N, 2*N-3+1):
        return sigma(l+1)-3*sigma(l+1-N)
    if l in range(2*N-3+1, 3*N-3+1):
        return sigma(3*N-2-l)
    return 0

def oracle2(l, i):
    L = max(0, l-i-(N-1))
    R = min(N-1, l-i)
    return max(0, R-L+1)

def oracle3(l, i, j):
    k = l - i - j
    if k in range(N):
        return 1
    return 0

N, K = map(int, input().split())
for l in range(0, 3*N-2):
    d = oracle1(l)
    if K-d <= 0:
        break
    K -= d
for i in range(N):
    d = oracle2(l, i)
    if K-d <= 0:
        break
    K -= d
for j in range(N):
    d = oracle3(l, i, j)
    if K-d <= 0:
        break
    K -= d
k = l - i - j
print(i+1, j+1, k+1)
```

ã¾ãŸã€ã‚°ãƒ©ãƒ•ã®ä½œæˆã«ç”¨ã„ãŸã‚³ãƒ¼ãƒ‰ã‚‚å«ã‚ã¦ãŠãã€‚

```python linenums="1"
import pandas as pd
import plotly.express as px
from itertools import product

N = 5

def level(l):
    if l in range(0, N):
        return "0â‰¤l<N"
    if l in range(N, 2*N-2):
        return "Nâ‰¤l<2N-2"
    if l in range(2*N-2, 3*N-2):
        return "2N-2â‰¤l<3N-2"

df = pd.DataFrame(
    [
        [i,j,k,level(i+j+k)]
        for i,j,k in product(*[range(N)]*3)
    ],
    columns=['i','j','k','i+j+k=l']
)

fig = px.scatter_3d(
    df,
    x='i',
    y='j',
    z='k',
    color='i+j+k=l',
)

fig.update_layout(
    margin=dict(l=0,r=0,b=0,t=0),
    scene=dict(
        xaxis=dict(tickmode='linear',tick0=0,dtick=1),
        yaxis=dict(tickmode='linear',tick0=0,dtick=1),
        zaxis=dict(tickmode='linear',tick0=0,dtick=1),
    ),
    legend=dict(
        y=0.01,
        x=0.01,
    ),
)
fig.show()
```
